/*!
   angular-block-ui v0.0.12
   (c) 2014 (null) McNull https://github.com/McNull/angular-block-ui
   License: MIT
*/
!function(t){var n=t.module("blockUI",[]);n.config(["$provide","$httpProvider",function(t,n){t.decorator("$exceptionHandler",["$delegate","$injector",function(t,n){var e,o;return function(i,c){o=o||n.get("blockUIConfig"),o.resetOnException&&(e=e||n.get("blockUI"),e.instances.reset()),t(i,c)}}]),n.interceptors.push("blockUIHttpInterceptor")}]),n.run(["$document","blockUIConfig","$templateCache",function(t,n){n.autoInjectBodyBlock&&t.find("body").attr("block-ui","main")}]),n.directive("blockUiContainer",["blockUIConfig","blockUiContainerLinkFn",function(t,n){return{scope:!0,restrict:"A",templateUrl:t.templateUrl,link:n}}]).factory("blockUiContainerLinkFn",["blockUI","blockUIUtils",function(){return function(t,n){n.addClass("block-ui-container");var e=n.inheritedData("block-ui");if(!e)throw new Error("No parent block-ui service instance located.");t.state=e.state(),t.$watch("state.blocking",function(t){n.toggleClass("block-ui-visible",!!t)}),t.$watch("state.blockCount > 0",function(t){n.toggleClass("block-ui-active",!!t)})}}]),n.directive("blockUi",["blockUiCompileFn",function(t){return{restrict:"A",compile:t}}]).factory("blockUiCompileFn",["blockUiLinkFn",function(t){return function(n){return n.append("<div block-ui-container></div>"),t}}]).factory("blockUiLinkFn",["blockUI","blockUIUtils","blockUIConfig",function(t,n,e){function o(t,n){n&&"none"!==n&&t.addClass("block-ui-"+n)}return function(i,c,r){c.addClass("block-ui"),o(c,r.blockUiAnimation||e.animation);var a=r.blockUi||"_"+i.$id,l=t.instances.get(a);if("main"===a)var u=i.$on("$viewContentLoaded",function(){u(),i.$on("$locationChangeStart",function(t){l.state().blockCount>0&&t.preventDefault()})});else{var s=c.inheritedData("block-ui");s&&(l._parent=s)}i.$on("$destroy",function(){l.release()}),l.addRef(),i.$watch(function(){return l.state().blocking},function(t){c.attr("aria-busy",t)});var f=r.blockUiPattern;if(f){var k=n.buildRegExp(f);l.pattern(k)}c.data("block-ui",l)}}]),n.provider("blockUIConfig",function(){var n={templateUrl:"angular-block-ui/angular-block-ui.ng.html",delay:250,message:"Loading ...",autoBlock:!0,resetOnException:!0,requestFilter:t.noop,autoInjectBodyBlock:!0,animation:"fade"};this.templateUrl=function(t){n.templateUrl=t},this.template=function(t){n.template=t},this.delay=function(t){n.delay=t},this.message=function(t){n.message=t},this.autoBlock=function(t){n.autoBlock=t},this.resetOnException=function(t){n.resetOnException=t},this.requestFilter=function(t){n.requestFilter=t},this.autoInjectBodyBlock=function(t){n.autoInjectBodyBlock=t},this.animation=function(t){n.animation=t},this.$get=["$templateCache",function(t){return n.template&&(n.templateUrl="$$block-ui-template$$",t.put(n.templateUrl,n.template)),n}]}),n.factory("blockUIHttpInterceptor",["$q","$injector","blockUIConfig",function(t,n,e){function o(){r=r||n.get("blockUI")}function i(t){e.autoBlock&&!t.$_noBlock&&t.$_blocks&&(o(),t.$_blocks.stop())}function c(n){return i(n.config),t.reject(n)}var r;return{request:function(t){return e.autoBlock&&(e.requestFilter(t)===!1?t.$_noBlock=!0:(o(),t.$_blocks=r.instances.locate(t),t.$_blocks.start())),t},requestError:c,response:function(t){return i(t.config),t},responseError:c}}]),n.factory("blockUI",["blockUIConfig","$timeout","blockUIUtils","$document",function(n,e,o,i){function c(c){var a,u=this,s={id:c,blockCount:0,message:n.message,blocking:!1},f=[];this._refs=0,this.start=function(c){c=s.blockCount>0?c||s.message||n.message:c||n.message,s.message=c,s.blockCount++;var r=t.element(i[0].activeElement);r.length&&o.isElementInBlockScope(r,u)&&(u._restoreFocus=r[0],e(function(){u._restoreFocus&&u._restoreFocus.blur()})),a||(a=e(function(){a=null,s.blocking=!0},n.delay))},this._cancelStartTimeout=function(){a&&(e.cancel(a),a=null)},this.stop=function(){s.blockCount=Math.max(0,--s.blockCount),0===s.blockCount&&u.reset(!0)},this.message=function(t){s.message=t},this.pattern=function(t){return void 0!==t&&(u._pattern=t),u._pattern},this.reset=function(n){u._cancelStartTimeout(),s.blockCount=0,s.blocking=!1,!u._restoreFocus||i[0].activeElement&&i[0].activeElement!==r[0]||(u._restoreFocus.focus(),u._restoreFocus=null);try{n&&t.forEach(f,function(t){t()})}finally{f.length=0}},this.done=function(t){f.push(t)},this.state=function(){return s},this.addRef=function(){u._refs+=1},this.release=function(){--u._refs<=0&&l.instances._destroy(u)}}var r=i.find("body"),a=[];a.get=function(t){var n=a[t];return n||(n=a[t]=new c(t),a.push(n)),n},a._destroy=function(n){if(t.isString(n)&&(n=a[n]),n){n.reset(),delete a[n.state().id];for(var e=a.length;--e;)if(a[e]===n){a.splice(e,1);break}}},a.locate=function(t){var n=[];o.forEachFnHook(n,"start"),o.forEachFnHook(n,"stop");for(var e=a.length;e--;){var i=a[e],c=i._pattern;c&&c.test(t.url)&&n.push(i)}return 0===n.length&&n.push(l),n},o.forEachFnHook(a,"reset");var l=a.get("main");return l.addRef(),l.instances=a,l}]),n.factory("blockUIUtils",function(){var t={buildRegExp:function(t){var n,e=t.match(/^\/(.*)\/([gim]*)$/);if(!e)throw Error("Incorrect regular expression format: "+t);return n=new RegExp(e[1],e[2])},forEachFn:function(t,n,e){for(var o=t.length;o--;){var i=t[o];i[n].apply(i,e)}},forEachFnHook:function(n,e){n[e]=function(){t.forEachFn(this,e,arguments)}},isElementInBlockScope:function(t,n){for(var e=t.inheritedData("block-ui");e;){if(e===n)return!0;e=e._parent}return!1}};return t}),t.module("blockUI").run(["$templateCache",function(t){t.put("angular-block-ui/angular-block-ui.ng.html",'<div class="block-ui-overlay"></div><div class="block-ui-message-container" aria-live="assertive" aria-atomic="true"><div class="block-ui-message">{{ state.message }}</div></div>')}])}(angular);
//# sourceMappingURL=angular-block-ui.min.js.map